<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <title>{{ page.title }}</title>
        <meta charset="utf-8">

        <!-- Bootstrap -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="../../bootstrap/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
        <link href="../../bootstrap/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

        <!-- Project CSS -->
        <link href="../../css/project.css" rel="stylesheet">

        <!-- Modernize this -->
        <script type="text/javascript" src="../../js/modernizr.custom.27793.js"></script>
    </head>
    <body>
        <div class="main-container">
            <div class="inside">
                <div class="content group">
                    {{ content }}
                </div>
            </div>
        </div>

        <!-- Grab Google CDN's jQuery. fall back to local if necessary -->
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script>!window.jQuery && document.write(unescape('%3Cscript src="../../js/jquery-1.8.3.js"%3E%3C/script%3E'))</script>

        <script src="../../bootstrap/bootstrap/js/bootstrap.min.js"></script>
        <script src="../../js/jquery.flexslider.js"></script>
        <script type="text/javascript">
            $(function() {
                $('#total-pages').text($('.gallery img').length);
                $('.gallery img:first-child').show();

                // Allow multiple text sections which are switched out part way through a gallery
                var sections = $(".description-col section");
                var numSections = sections.length;

                $('.gallery').flexslider({
                    namespace: '',
                    controlNav: false,
                    directionNav: false,
                    pauseOnHover: true,
                    before: function() {

                        // Don't do anything if no text sections
                        if (numSections === 0) {
                            return;
                        }

                        var flexslider = $('.gallery').data('flexslider');
                        var nextSlide = flexslider.currentSlide + 1; // 1 as a base

                        console.log("next slide" + nextSlide);

                        sections.each(function() {
                            var triggerSlide = $(this).data('slide');

                            if (nextSlide === triggerSlide) {

                                console.log("switching text section to " + nextSlide);

                                // Hide all sections
                                $('section.book').hide();

                                // Show correct one
                                $(this).show();

                                // Jump out of loop
                                return false;
                            }
                        })

                    },
                    after: function(){
                        var flexslider = $('.gallery').data('flexslider');
                        $('#current-page').text(flexslider.currentSlide + 1);
                    }
                });

                $('.page-nav .next').on('click', function(e) {
                    e.preventDefault();
                    $('.gallery').flexslider("next");
                })

                $('.page-nav .prev').on('click', function(e) {
                    e.preventDefault();
                    $('.gallery').flexslider("prev");
                })

            });

        </script>
    </body>
</html>
